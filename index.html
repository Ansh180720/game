<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Monster Shooter — Mobile Friendly</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<style>
  html,body{
    height:100%; margin:0; background:#111; font-family:Arial; color:#fff;
    display:flex; justify-content:center; align-items:center;
  }

  #phone{
    width:360px; height:720px; background:#000; border-radius:18px;
    position:relative; overflow:hidden; box-shadow:0 0 30px #000;
  }

  #gameArea{
    position:absolute; top:0; left:0; right:0; bottom:180px;
    display:flex; justify-content:center; align-items:center;
  }

  canvas{
    background:#000;
    width:100%; height:100%;
  }

  #controls{
    position:absolute; bottom:0; left:0; width:100%;
    height:180px;
    display:flex; justify-content:space-between;
    padding:10px;
    box-sizing:border-box;
  }

  #fireBtn{
    width:90px; height:90px; background:#ff3333; border-radius:999px;
    display:flex; align-items:center; justify-content:center;
    font-size:20px; font-weight:bold; user-select:none;
    border:3px solid rgba(255,255,255,0.2);
  }

  .moveBtn{
    width:80px; height:80px;
    background:#222; border-radius:16px; border:3px solid #555;
    display:flex; align-items:center; justify-content:center;
    font-size:32px; user-select:none;
  }

  #move{
    display:flex; flex-direction:column; align-items:center; gap:6px;
  }

  #leftRight{
    display:flex; gap:6px;
  }

  .overlay{
    position:absolute; inset:0; background:#000a; z-index:20;
    display:flex; flex-direction:column; justify-content:center;
    align-items:center;
  }

  .btn{
    padding:16px 28px; background:#007aff; border-radius:12px;
    font-size:20px; cursor:pointer; margin-top:20px;
  }
</style>
</head>
<body>

<div id="phone">

  <div id="gameArea">
    <canvas id="game" width="600" height="700"></canvas>
  </div>

  <div id="startScreen" class="overlay">
    <h2>MONSTER SHOOTER</h2>
    <div id="startBtn" class="btn">START</div>
  </div>

  <div id="retryScreen" class="overlay" style="display:none">
    <h2>GAME OVER</h2>
    <div id="retryBtn" class="btn">RETRY</div>
  </div>

  <div id="controls">
    <div id="fireBtn">FIRE</div>
    <div id="move">
      <div id="up" class="moveBtn">▲</div>
      <div id="leftRight">
        <div id="left" class="moveBtn">◀</div>
        <div id="right" class="moveBtn">▶</div>
      </div>
      <div id="down" class="moveBtn">▼</div>
    </div>
  </div>

</div>

<script>
/* ---------------- GAME LOGIC (unchanged) ---------------- */
let gameStarted = false;

(() => {
  const canvas=document.getElementById('game');
  const ctx=canvas.getContext('2d');
  const W=600,H=700;

  const HERO_SIZE=40, HERO_X=250, HERO_Y=500;
  const SPEED=20;

  let heroX,heroY,bullets,monsters,score,gameOver,monsterSpeed,spawnRate;

  window.moveLeft=false;
  window.moveRight=false;
  window.moveUp=false;
  window.moveDown=false;
  window.mouseHeld=false;

  function reset(){
    heroX=HERO_X; heroY=HERO_Y;
    bullets=[]; monsters=[];
    score=0; gameOver=false;
    monsterSpeed=2; spawnRate=50;
  }
  window.globalReset = reset;

  function intersect(a,b){
    return !(a.x+a.w<b.x || b.x+b.w<a.x || a.y+a.h<b.y || b.y+b.h<a.y);
  }

  window.globalGameOver = ()=>{
    gameOver=true;
    document.getElementById("retryScreen").style.display="flex";
  };

  function draw(){
    ctx.fillStyle="#000"; ctx.fillRect(0,0,W,H);
    ctx.fillStyle="#0ff"; ctx.fillRect(heroX,heroY,HERO_SIZE,HERO_SIZE);

    ctx.fillStyle="#ff0";
    bullets.forEach(b=>ctx.fillRect(b.x,b.y,b.w,b.h));

    ctx.fillStyle="#f44";
    monsters.forEach(m=>ctx.fillRect(m.x,m.y,m.w,m.h));

    ctx.fillStyle="#fff"; ctx.font="22px Arial";
    ctx.fillText("Score: "+score,20,40);
  }

  function tick(){
    if(!gameStarted||gameOver){ requestAnimationFrame(tick); return; }

    if(moveLeft)heroX-=SPEED;
    if(moveRight)heroX+=SPEED;
    if(moveUp)heroY-=SPEED;
    if(moveDown)heroY+=SPEED;

    heroX=Math.max(0,Math.min(W-HERO_SIZE,heroX));
    heroY=Math.max(0,Math.min(H-HERO_SIZE,heroY));

    if(mouseHeld && Math.random()*4<1)
      bullets.push({x:heroX+15,y:heroY,w:10,h:20});

    if(Math.random()*spawnRate < 1)
      monsters.push({x:Math.random()*(W-40),y:0,w:40,h:40});

    if(score>15){ monsterSpeed=4; spawnRate=40; }
    if(score>40){ monsterSpeed=6; spawnRate=30; }
    if(score>70){ monsterSpeed=8; spawnRate=20; }

    bullets.forEach(b=>b.y-=12);
    bullets = bullets.filter(b=>b.y>0);

    for(let m=monsters.length-1; m>=0; m--){
      monsters[m].y += monsterSpeed;
      if(monsters[m].y>H) globalGameOver();
    }

    bullets.forEach((b,bi)=>{
      monsters.forEach((m,mi)=>{
        if(intersect(
          {x:b.x,y:b.y,w:b.w,h:b.h},
          {x:m.x,y:m.y,w:m.w,h:m.h}
        )){
          monsters.splice(mi,1);
          bullets.splice(bi,1);
          score++;
        }
      });
    });

    draw();
    requestAnimationFrame(tick);
  }

  reset();
  requestAnimationFrame(tick);
})();

/* ------------- FIXED INPUT (pointer events for multitouch) ------------- */
function bind(id, down, up){
  const el=document.getElementById(id);

  el.addEventListener("pointerdown", e=>{e.preventDefault(); down();});
  el.addEventListener("pointerup",   e=>{e.preventDefault(); up();});
  el.addEventListener("pointerleave",e=>{e.preventDefault(); up();});
}

bind("left", ()=>moveLeft=true, ()=>moveLeft=false);
bind("right",()=>moveRight=true,()=>moveRight=false);
bind("up",   ()=>moveUp=true,   ()=>moveUp=false);
bind("down", ()=>moveDown=true, ()=>moveDown=false);
bind("fireBtn",()=>mouseHeld=true,()=>mouseHeld=false);

/* start / retry */
document.getElementById("startBtn").onclick = ()=>{
  document.getElementById("startScreen").style.display="none";
  gameStarted=true; globalReset();
};

document.getElementById("retryBtn").onclick = ()=>{
  document.getElementById("retryScreen").style.display="none";
  gameStarted=true; globalReset();
};
</script>

</body>
</html>
