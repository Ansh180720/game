<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Monster Shooter Game - Improved Controls</title>

  <style>
    html, body {
      height: 100%;
      margin: 0;
      background: #222;
      overflow: hidden;
      touch-action: none;
    }

    #gameContainer {
      position: relative;
      width: 100vw;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    canvas {
      background: #000;
      width: 100%;
      height: 100%;
    }

    /* OVERLAYS */
    .overlayScreen {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: #000a;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-family: Arial;
      z-index: 20;
    }

    .gameBtn {
      padding: 40px 70px;
      background: #0af;
      color: #fff;
      border-radius: 15px;
      font-size: 28px;
      border: 3px solid #fff;
      margin-top: 20px;
      user-select: none;
    }

    /* IMPROVED CONTROLS */
    #controls {
      position: absolute;
      bottom: 200px;                /* HIGHER from bottom */
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 60px;              /* padding from edges */
      z-index: 5;
      pointer-events: auto;
    }

    .btnGroup {
      display: flex;
      flex-direction: column;
      gap: 32px;                    /* more gap between controls */
    }

    .ctrlBtn {
      width: 110px;
      height: 110px;
      border-radius: 50%;
      background: #ffffff55;
      border: 3px solid #fff;
      color: #fff;
      font-size: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      user-select: none;
      touch-action: manipulation;   /* less accidental touch movement */
    }

    #fireBtn {
      width: 150px;
      height: 150px;
      font-size: 34px;
      background: #ff3333cc;
      border: 4px solid #fff;
      border-radius: 50%;
    }

    /* Extra gap for movement left-right group */
    .midRow {
      display: flex;
      gap: 30px;
      justify-content: center;
    }

    /* SMALLER SCREEN SUPPORT */
    @media (max-width: 600px) {
      #controls {
        bottom: 170px;
        padding: 0 40px;
      }

      .ctrlBtn {
        width: 90px;
        height: 90px;
        font-size: 28px;
      }

      #fireBtn {
        width: 130px;
        height: 130px;
        font-size: 30px;
      }

      .btnGroup {
        gap: 28px;
      }

      .midRow {
        gap: 25px;
      }
    }

  </style>
</head>
<body>

<div id="gameContainer">

  <canvas id="game" width="600" height="700"></canvas>

  <!-- START SCREEN -->
  <div id="startScreen" class="overlayScreen">
    <h1>MONSTER SHOOTER</h1>
    <div id="startBtn" class="gameBtn">START</div>
  </div>

  <!-- RETRY SCREEN -->
  <div id="retryScreen" class="overlayScreen" style="display:none;">
    <h1>GAME OVER</h1>
    <div id="retryBtn" class="gameBtn">RETRY</div>
  </div>

  <!-- IMPROVED CONTROLS -->
  <div id="controls">

    <!-- FIRE BUTTON (LEFT) -->
    <div class="btnGroup">
      <div id="fireBtn" class="ctrlBtn">FIRE</div>
    </div>

    <!-- MOVEMENT (RIGHT) -->
    <div class="btnGroup">
      <div id="up" class="ctrlBtn">▲</div>

      <div class="midRow">
        <div id="left" class="ctrlBtn">◀</div>
        <div id="right" class="ctrlBtn">▶</div>
      </div>

      <div id="down" class="ctrlBtn">▼</div>
    </div>

  </div>

</div>

<!-- GAME LOGIC (NOT CHANGED AT ALL) -->
<script>
/* YOUR ORIGINAL GAME LOGIC — UNCHANGED */
let gameStarted = false;
let globalReset;
let globalGameOver;

(() => {
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');

  const WIDTH = 600, HEIGHT = 700;
  const HERO_SIZE = 40;
  const HERO_START_X = 250, HERO_START_Y = 500;
  const HERO_SPEED = 20;
  const BULLET_W = 10, BULLET_H = 20;
  const MONSTER_W = 40, MONSTER_H = 40;

  window.moveLeft=false; window.moveRight=false;
  window.moveUp=false; window.moveDown=false;
  window.mouseHeld=false;

  let heroX, heroY, score, gameOver, bullets, monsters, monsterSpeed, spawnRate;

  function rectsIntersect(a, b){
    return !(a.x+a.width<=b.x || b.x+b.width<=a.x || a.y+a.height<=b.y || b.y+b.height<=a.y);
  }

  function resetGame(){
    heroX=HERO_START_X; heroY=HERO_START_Y;
    bullets=[]; monsters=[];
    score=0; gameOver=false;
    monsterSpeed=2; spawnRate=50;
  }

  globalReset = resetGame;

  globalGameOver = () => {
    gameOver=true;
    document.getElementById("retryScreen").style.display="flex";
  };

  function draw(){
    ctx.fillStyle='#000';
    ctx.fillRect(0,0,WIDTH,HEIGHT);

    ctx.fillStyle='#0ff';
    ctx.fillRect(heroX,heroY,HERO_SIZE,HERO_SIZE);

    ctx.fillStyle='#ff0';
    bullets.forEach(b=>ctx.fillRect(b.x,b.y,b.width,b.height));

    ctx.fillStyle='#f44';
    monsters.forEach(m=>ctx.fillRect(m.x,m.y,m.width,m.height));

    ctx.fillStyle='#fff';
    ctx.font='22px Arial';
    ctx.fillText('Score: '+score,20,40);
  }

  function tick(){
    if(!gameStarted || gameOver){ requestAnimationFrame(tick); return; }

    if(moveLeft) heroX-=HERO_SPEED;
    if(moveRight) heroX+=HERO_SPEED;
    if(moveUp) heroY-=HERO_SPEED;
    if(moveDown) heroY+=HERO_SPEED;

    heroX=Math.max(0,Math.min(WIDTH-HERO_SIZE,heroX));
    heroY=Math.max(0,Math.min(HEIGHT-HERO_SIZE,heroY));

    if(mouseHeld && Math.random()*4<1)
      bullets.push({x:heroX+15,y:heroY,width:BULLET_W,height:BULLET_H});

    if(Math.random()*spawnRate<1)
      monsters.push({x:Math.random()*(WIDTH-MONSTER_W),y:0,width:MONSTER_W,height:MONSTER_H});

    if(score>15){monsterSpeed=4;spawnRate=40;}
    if(score>40){monsterSpeed=6;spawnRate=30;}
    if(score>70){monsterSpeed=8;spawnRate=20;}

    for(let i=bullets.length-1;i>=0;i--){
      bullets[i].y-=12;
      if(bullets[i].y<0) bullets.splice(i,1);
    }

    for(let i=monsters.length-1;i>=0;i--){
      monsters[i].y+=monsterSpeed;
      if(monsters[i].y>HEIGHT) globalGameOver();
    }

    for(let bi=bullets.length-1;bi>=0;bi--){
      for(let mi=monsters.length-1;mi>=0;mi--){
        if(rectsIntersect(bullets[bi],monsters[mi])){
          monsters.splice(mi,1);
          bullets.splice(bi,1);
          score++;
          break;
        }
      }
    }

    draw();
    requestAnimationFrame(tick);
  }

  requestAnimationFrame(tick);
})();

/* BUTTON HOLD HANDLING — REFINED TO STOP "AUTO FIRE" */
function bindHold(id, downFn, upFn){
  const el=document.getElementById(id);

  el.addEventListener('touchstart', e=>{ e.preventDefault(); downFn(); });
  el.addEventListener('touchend',   e=>{ e.preventDefault(); upFn(); });
  el.addEventListener('touchcancel',e=>{ e.preventDefault(); upFn(); });

  el.addEventListener('mousedown', ()=>downFn());
  el.addEventListener('mouseup',   ()=>upFn());
  el.addEventListener('mouseleave',()=>upFn());   /* fixes ghost input */
}

bindHold('left', ()=>moveLeft=true, ()=>moveLeft=false);
bindHold('right', ()=>moveRight=true, ()=>moveRight=false);
bindHold('up', ()=>moveUp=true, ()=>moveUp=false);
bindHold('down', ()=>moveDown=true, ()=>moveDown=false);
bindHold('fireBtn', ()=>mouseHeld=true, ()=>mouseHeld=false);

document.getElementById("startBtn").onclick = () => {
  document.getElementById("startScreen").style.display = "none";
  gameStarted = true;
  globalReset();
};

document.getElementById("retryBtn").onclick = () => {
  document.getElementById("retryScreen").style.display = "none";
  gameStarted = true;
  globalReset();
};
</script>

</body>
</html>
